jQuery(document).ready(function($){var userLogin=gpToolbox.user_login,userLocale=gpToolbox.user_locale,tablePermissionAdmin=$("table.gp-table.permission-admin"),tablePermissionValidator=$("table.gp-table.permission-validator"),glotpressAdmin=gpToolbox.admin,permissionValidatorsRows=$(".permission-validator tbody").find("tr"),permissionAdminsRows=$(".permission-admin tbody").find("tr");function permissionDelete(permissionType,permissionID){var tr=$("table.gp-toolbox.permission-"+permissionType).find('tbody tr[gptoolboxdata-permission="'+permissionID+'"]'),td=$(tr).find("td.action"),notice=$(td).find("div.progress-notice"),button=$(td).find("button.delete"),td=$(td).find("span.duplicate");$(button).hide().attr("disabled",!0),$(td).hide(),$(notice).text(wp.i18n.__("Deleting...","gp-toolbox")).fadeIn(),$.ajax({url:wpApiSettings.root+"gp-toolbox/v1/permissions/"+permissionID+"/-delete",type:"POST",data:{_wpnonce:gpToolbox.nonce},success:function(response){var permissionsCount=$("p#permission-"+permissionType+"-count span.count").text();!0===response.deleted?($(tr).fadeOut(),0<(permissionsCount-=1)?$("p#permission-"+permissionType+"-count").html(sprintf(wp.i18n._n("%s Permission found.","%s Permissions found.",permissionsCount,"gp-toolbox"),'<span class="count">'+new Intl.NumberFormat(userLocale.slug).format(permissionsCount)+"</span>")):($("p#permission-"+permissionType+"-count").text(wp.i18n.__("No permissions found.","gp-toolbox")),$("div.permission-"+permissionType+"-filter").fadeOut(),$("table.gp-toolbox.permission-"+permissionType).fadeOut())):($(notice).hide().text(""),$(notice).text(wp.i18n.sprintf(wp.i18n.__("Error: %s","gp-toolbox"),response.message)),$(notice).fadeIn())},error:function(response){},complete:function(){}})}tablePermissionAdmin.length&&$(tablePermissionAdmin).children("tbody").children("tr").each(function(){var permissionID=$(this).attr("gptoolboxdata-permission");glotpressAdmin&&($(this).find("td.user").text().trim()===userLogin?$(this).find("td.action button.delete").attr("disabled",!0):$(this).find("td.action button.delete").on("click",function(){permissionDelete("admin",permissionID)}))}),tablePermissionValidator.length&&$(tablePermissionValidator).children("tbody").children("tr").each(function(){var permissionID=$(this).attr("gptoolboxdata-permission");glotpressAdmin&&$(this).find("td.action button.delete").on("click",function(){permissionDelete("validator",permissionID)})}),$(".permission-admin").tablesorter({theme:"glotpress",sortList:[[1,0]],headers:{0:{sorter:"text"}}}),$("#permission-admin-filter").bind("change keyup input",function(){var words=this.value.toLowerCase().split(" ");(""===this.value.trim()?permissionAdminsRows:(permissionAdminsRows.hide(),permissionAdminsRows.filter(function(){for(var t=$(this),d=0;d<words.length;++d)if(-1!==t.text().toLowerCase().indexOf(words[d]))return!0;return!1}))).show()}),$(".permission-validator").tablesorter({theme:"glotpress",sortList:[[1,2],[2,0],[3,0]],headers:{0:{sorter:"text"}}}),$("#permission-validator-filter").bind("change keyup input",function(){var words=this.value.toLowerCase().split(" ");(""===this.value.trim()?permissionValidatorsRows:(permissionValidatorsRows.hide(),permissionValidatorsRows.filter(function(){for(var t=$(this),d=0;d<words.length;++d)if(-1!==t.text().toLowerCase().indexOf(words[d]))return!0;return!1}))).show()}),$("button#permission-admin-filter-clear").click(function(){$("input#permission-admin-filter").val(""),$(".permission-admin tbody").find("tr").show()}),$("button#permission-validator-filter-clear").click(function(){$("input#permission-validator-filter").val(""),$(".permission-validator tbody").find("tr").show()})});