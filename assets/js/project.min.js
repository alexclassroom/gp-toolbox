jQuery(document).ready(function($){var userLocale=gpToolboxProject.user_locale,supportedTranslationStatuses=gpToolboxProject.supported_statuses,tableTranslationSets=$("table.gp-table.translation-sets"),glotpressAdmin=gpToolboxProject.admin,gpUrlProject=gpToolboxProject.gp_url_project,project=gpToolboxProject.args.project,dataPrefix="gptoolboxdata-",highlightCounts=!1;function deleteTranslations(locale,slug,status){var button=$(tableTranslationSets).find('tbody tr[gptoolboxdata-locale="'+locale+'"]['+dataPrefix+'slug="'+slug+'"] td.stats.'+status+" div button.delete");$.ajax({url:gpToolboxProject.ajaxurl,type:"POST",data:{action:"delete_translations",projectPath:project.path,locale:locale,slug:slug,status:status,nonce:gpToolboxProject.nonce},beforeSend:function(){button.attr("disabled",!0),function getProgress(element,step){$.ajax({url:gpToolboxProject.ajaxurl,type:"POST",data:{action:"get_progress",step:step,nonce:gpToolboxProject.nonce},success:function(response){response.success&&(response=response.data.progress,$(element).css("background","linear-gradient(90deg, var(--gp-color-secondary-100) "+response+"%, var(--gp-color-status-rejected-subtle) "+response+"%)"),response<100)&&getProgress(element,response+1)},error:function(){}})}(button.closest("td"),1)}}).done(function(response,textStatus,jqXHR){var old=response.data.old,response=response.data.rejected;$(button).closest("td").hasClass("old")&&($(old).closest("td").removeClass("highlight"),button.closest("div").children("a").text(new Intl.NumberFormat(userLocale.slug).format(old)),button.addClass("hidden")),$(button).closest("td").hasClass("rejected")&&($(response).closest("td").removeClass("highlight"),button.closest("div").children("a").text(new Intl.NumberFormat(userLocale.slug).format(response)),button.addClass("hidden")),updateHighlight(button.closest("td"))}).fail(function(jqXHR,textStatus){}).always(function(){})}function updateHighlight(element){!1!==highlightCounts&&(element?"0"===$(element).find("a").text()?$(element).removeClass("highlight"):$(element).addClass("highlight"):$(tableTranslationSets).find("td.stats").each(function(){"0"===$(this).find("a").text()?$(this).removeClass("highlight"):$(this).addClass("highlight")}))}"1"===gpToolboxProject.highlight_counts&&(highlightCounts=!0),tableTranslationSets.length&&(supportedTranslationStatuses.hasOwnProperty("old")&&$(tableTranslationSets).children("thead").children("tr").find("th:last").after('<th class="gptoolbox-column-old">'+wp.i18n.__("Old","gp-toolbox")+"</td>"),supportedTranslationStatuses.hasOwnProperty("rejected")&&$(tableTranslationSets).children("thead").children("tr").find("th:last").after('<th class="gptoolbox-column-rejected">'+wp.i18n.__("Rejected","gp-toolbox")+"</td>"),supportedTranslationStatuses.hasOwnProperty("changesrequested")&&$(tableTranslationSets).children("thead").children("tr").find("th:last").after('<th class="gptoolbox-column-changesrequested">'+wp.i18n.__("Changes requested","gp-toolbox")+"</td>"),$(tableTranslationSets).children("tbody").children("tr").each(function(){supportedTranslationStatuses.hasOwnProperty("old")&&$(this).find("td:last").after('<td class="stats old"></td>'),supportedTranslationStatuses.hasOwnProperty("rejected")&&$(this).find("td:last").after('<td class="stats rejected"></td>'),supportedTranslationStatuses.hasOwnProperty("changesrequested")&&$(this).find("td:last").after('<td class="stats changesrequested"></td>'),$(this).children("td:first-child").find("a").each(function(){var regexPattern=new RegExp("^"+gpUrlProject+".*"+project.path+"/(.*)/(.*)/$"),regexPattern=$(this).attr("href").match(regexPattern),locale=regexPattern[1],regexPattern=regexPattern[2];$(this).closest("tr").attr(dataPrefix+"locale",locale),$(this).closest("tr").attr(dataPrefix+"slug",regexPattern),$(this).closest("tr").attr(dataPrefix+"projectpath",project.path)})}),$(tableTranslationSets).children("tbody").children("tr").each(function(){var locale=$(this).attr("gptoolboxdata-locale"),translationSet=gpToolboxProject.args.translation_sets[locale],locale=$(this).children("td:first-child").find("a").attr("href"),old=$(this).children("td.stats.old"),rejected=$(this).children("td.stats.rejected");supportedTranslationStatuses.hasOwnProperty("old")&&$(this).find("td.stats.old").attr("data-text",translationSet.old_count).html('<div><a class="count" href="'+locale+'?filters[status]=old">'+new Intl.NumberFormat(userLocale.slug).format(translationSet.old_count)+"</a></div>"),supportedTranslationStatuses.hasOwnProperty("rejected")&&$(this).find("td.stats.rejected").attr("data-text",translationSet.rejected_count).html('<div><a class="count" href="'+locale+'?filters[status]=rejected">'+new Intl.NumberFormat(userLocale.slug).format(translationSet.rejected_count)+"</a></div>"),supportedTranslationStatuses.hasOwnProperty("changesrequested")&&$(this).find("td.stats.changesrequested").attr("data-text",translationSet.changesrequested_count).html('<div><a class="count" href="'+locale+'?filters[status]=changesrequested">'+new Intl.NumberFormat(userLocale.slug).format(translationSet.changesrequested_count)+"</a></div>"),glotpressAdmin&&($(old).find("div a.count").after('<button class="delete hidden" disabled><span class="dashicons dashicons-trash"></span></button>'),$(rejected).find("div a.count").after('<button class="delete hidden" disabled><span class="dashicons dashicons-trash"></span></button></div>'),"0"!==$(old).find("div a.count").text().trim()&&$(old).find("div button.delete").attr("disabled",!1).removeClass("hidden"),"0"!==$(rejected).find("div a.count").text().trim()&&$(rejected).find("div button.delete").attr("disabled",!1).removeClass("hidden"),$(old).find("div button.delete").on("click",function(){deleteTranslations(translationSet.locale,translationSet.slug,"old")}),$(rejected).find("div button.delete").on("click",function(){deleteTranslations(translationSet.locale,translationSet.slug,"rejected")}))}),updateHighlight())});